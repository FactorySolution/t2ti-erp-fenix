CREATE
VIEW VIEW_PESSOA_FORNECEDOR
AS

select 
	F.ID,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, 
	PF.CPF AS "CPF_CNPJ", 
	PF.RG AS "RG_IE",
	F.DESDE,
	F.DATA_CADASTRO,
	F.OBSERVACAO,
	P.ID as "ID_PESSOA"
from
	PESSOA P 
	INNER JOIN PESSOA_FISICA PF ON (PF.ID_PESSOA = P.ID)
	INNER JOIN FORNECEDOR F ON (F.ID_PESSOA = P.ID)
where 
	P.FORNECEDOR = "S"

UNION

select 
	F.ID,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, 
	PJ.CNPJ AS "CPF_CNPJ", 
	PJ.INSCRICAO_ESTADUAL AS "RG_IE",
	F.DESDE,
	F.DATA_CADASTRO,
	F.OBSERVACAO,
	P.ID as "ID_PESSOA"
from
	PESSOA P 
	INNER JOIN PESSOA_JURIDICA PJ ON (PJ.ID_PESSOA = P.ID)
	INNER JOIN FORNECEDOR F ON (F.ID_PESSOA = P.ID)
where 
	P.FORNECEDOR = "S"